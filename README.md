
# üöÄ aiosubgram

![PyPI - Version](https://img.shields.io/pypi/v/aiosubgram?style=flat-square&color=blue)
![Python Version](https://img.shields.io/badge/python-3.9%2B-blue?style=flat-square&logo=python)
![License](https://img.shields.io/github/license/salatcs/aiosubgram?style=flat-square)
![Aiogram](https://img.shields.io/badge/aiogram-3.x-2ca5e0?style=flat-square&logo=telegram)

**aiosubgram** ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API —Å–µ—Ä–≤–∏—Å–∞ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ [subgram.org](https://subgram.org).

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª API, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–≥—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é (Pydantic) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ª–µ–≥–∫–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å **aiogram 3.x**.

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚ö° **–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è** (–Ω–∞ –±–∞–∑–µ `aiohttp`).
- üõ° **–°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è**: –í—Å–µ –æ—Ç–≤–µ—Ç—ã API –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Pydantic –º–æ–¥–µ–ª–∏.
- ü§ñ **Aiogram 3 Integration**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ Middleware –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –û–ü (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –ü–æ–¥–ø–∏—Å–∫–∏).
- üì¶ **–ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ API**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è **–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ–π**, **–í–ª–∞–¥–µ–ª—å—Ü–µ–≤ –±–æ—Ç–æ–≤ (Publisher)** –∏ **–û–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**.
- üõ† **–£–¥–æ–±–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ü–æ–Ω—è—Ç–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.

---

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

[aiosubgram Docs](https://salatcs.github.io/aiosubgram/)

---

## üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É —á–µ—Ä–µ–∑ pip:

```bash
pip install aiosubgram
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –≤–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –∫–ª—é—á–∏ –æ—Ç Subgram. –ò—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.

- **Secret Key**: –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ –∏ –±–æ—Ç–∞–º–∏.
- **API Token**: –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –±–∞–ª–∞–Ω—Å–∞.
- **API Key (Bot)**: –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–æ—Ç–∞.

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä (–ø–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞)

```python
import asyncio
from aiosubgram import SubgramClient

async def main():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
    client = SubgramClient(
        api_token="–í–ê–®_API_TOKEN"
    )

    async with client:
        balance = await client.get_balance()
        print(f"–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: {balance.balance}$")
        
        for bot in balance.bots_info:
            print(f"–ë–æ—Ç {bot.bot_username}: {bot.revenue}$")

if __name__ == "__main__":
    asyncio.run(main())
```

---

## ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Aiogram 3

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–æ—Ç–æ–≤—ã–π `Middleware`, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–ø–æ–Ω—Å–æ—Ä–æ–≤ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ª—é–±–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

### –ü—Ä–∏–º–µ—Ä –±–æ—Ç–∞ —Å –û–ü (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –ü–æ–¥–ø–∏—Å–∫–æ–π)

```python
import asyncio
from aiogram import Bot, Dispatcher, F
from aiogram.types import Message, CallbackQuery
from aiosubgram import SubgramClient
from aiosubgram.utils.middleware import OPMiddleware

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
BOT_TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"
SUBGRAM_API_KEY = "YOUR_SUBGRAM_BOT_API_KEY"

bot = Bot(token=BOT_TOKEN)
dp = Dispatcher()

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ Subgram
subgram = SubgramClient(api_key=SUBGRAM_API_KEY)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Middleware
dp.message.middleware(
    OPMiddleware(
        client=subgram,
        max_sponsors=3, # –ú–∞–∫—Å–∏–º—É–º –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏
        sub_text="üîí <b>–î–æ—Å—Ç—É–ø –∑–∞–∫—Ä—ã—Ç!</b>\n–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —Å–ø–æ–Ω—Å–æ—Ä–æ–≤:",
        done_button_text="‚úÖ –Ø –ø–æ–¥–ø–∏—Å–∞–ª—Å—è"
    )
)

@dp.message()
async def echo_handler(message: Message):
    # –≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å–∞–Ω
    await message.answer("üéâ –í—ã –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É! –ë–æ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω.")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–Ø –ø–æ–¥–ø–∏—Å–∞–ª—Å—è"
@dp.callback_query(F.data == "subgram-done")
async def check_sub(callback: CallbackQuery):
    response = await subgram.get_sponsors(
        chat_id=callback.message.chat.id,
        user_id=callback.from_user.id
    )
    
    if response.status == "ok":
        await callback.message.delete()
        await callback.message.answer("‚úÖ –°–ø–∞—Å–∏–±–æ! –î–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç.")
    else:
        await callback.answer("‚ùå –í—ã –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–µ –Ω–∞ –≤—Å–µ—Ö!", show_alert=True)

async def main():
    async with subgram:
        await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
```

---

## üìö –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### üì¢ –î–ª—è –í–ª–∞–¥–µ–ª—å—Ü–µ–≤ –ë–æ—Ç–æ–≤ (Publisher)

–ú–µ—Ç–æ–¥—ã –¥–ª—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞:

- `get_sponsors(...)` ‚Äî –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ (–û–ü).
- `add_bot(...)` ‚Äî –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º—É.
- `update(...)` ‚Äî –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞.
- `get_bot_info(...)` ‚Äî –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ.
- `get_user_info(...)` ‚Äî –ü–æ–ª—É—á–∏—Ç—å –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```python
# –ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–æ–Ω—Å–æ—Ä–æ–≤ –≤—Ä—É—á–Ω—É—é
sponsors = await client.get_sponsors(chat_id=123, user_id=456)
for sponsor in sponsors.sponsors:
    print(f"–ù—É–∂–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞: {sponsor.link}")
```

### üéØ –î–ª—è –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ–π (Advertiser)

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω—ã–º–∏ –∫–∞–º–ø–∞–Ω–∏—è–º–∏:

- `create_order(...)` ‚Äî –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (–ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –≤ –∫–∞–Ω–∞–ª/–±–æ—Ç).
- `update_order(...)` ‚Äî –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–∫–∞–∑–∞ (—Å—Ç–∞—Ç—É—Å, —Ü–µ–Ω–∞).
- `get_order_info(...)` ‚Äî –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
order = await client.create_order(
    link="https://t.me/my_channel",
    ads_type="channel",
    quantity_all=1000,
    price=1.3
)
print(f"–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω: ID {order.response.order_id}")
```

### üìä –û–±—â–∏–µ –º–µ—Ç–æ–¥—ã

- `get_balance()` ‚Äî –ë–∞–ª–∞–Ω—Å –∞–∫–∫–∞—É–Ω—Ç–∞.
- `get_statistic(...)` ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤/—Ä–∞—Å—Ö–æ–¥–æ–≤.
- `toggle_exclusion(...)` ‚Äî –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö –±–æ—Ç–æ–≤/–∫–∞–Ω–∞–ª–æ–≤.

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- aiohttp
- pydantic >= 2.0
- aiogram >= 3.x (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è utils)

---

## ü§ù Contributing

–ë–∞–≥–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ [Issues](https://github.com/salatcs/aiosubgram/issues). Pull Request'—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

---

<div align="center">
    <b>Copyright (c) 2025 salatcs</b>
</div>